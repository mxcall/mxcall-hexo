language: node_js
node_js:
  - "12.16.3"
dist: trusty
sudo: required

branches:
  only:
  - master

install:
  - npm install -g hexo-cli
  - hexo init blog
  - cd blog
  - npm install

script:
  - hexo clean
  - hexo generate

after_success:
  - sed -i'' "s~git@github.com:~https://s~git@github.com:~https://${GIT_REPO_TOKEN}@github.com/~" _config.yml
  - hexo deploy

notifications:
  email: true